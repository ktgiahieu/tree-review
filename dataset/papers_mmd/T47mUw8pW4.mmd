The medial axis of closed bounded sets is Lipschitz stable with respect to the Hausdorff distance under ambient diffeomorphisms

Anonymous Author(s)

Affiliation

Address

email

###### Abstract

We prove that the medial axis of closed sets is Hausdorff stable in the following sense: Let \(\mathcal{S}\subseteq\mathbb{R}^{d}\) be a fixed closed set that contains a bounding sphere. Consider the space of \(C^{1,1}\) diffeomorphisms of \(\mathbb{R}^{d}\) to itself, which keep the bounding sphere invariant. The map from this space of diffeomorphisms (endowed with a Banach norm) to the space of closed subsets of \(\mathbb{R}^{d}\) (endowed with the Hausdorff distance), mapping a diffeomorphism \(F\) to the closure of the medial axis of \(F(\mathcal{S})\), is Lipschitz.

This extends a previous stability result of Chazal and Soufflet on the stability of the medial axis of \(C^{2}\) manifolds under \(C^{2}\) ambient diffeomorphisms.

## 1 Introduction

In [19], Federer introduced the _reach_ of a (closed) set \(\mathcal{S}\subset\mathbb{R}^{d}\) as the infimum over all points in \(\mathcal{S}\) of the distance from these points to the _medial axis_\(\operatorname{ax}(\mathcal{S})\), the set of points in \(\mathbb{R}^{d}\) for which the closest point in \(\mathcal{S}\) is not unique. Federer also introduced the reach at a point \(p\in\mathcal{S}\) to be the distance from \(p\) to the medial axis of \(\mathcal{S}\). We now call this quantity the _local feature size_[3] and denote it by \(\operatorname{lfs}(p)\).

Federer proved that the reach is stable under \(C^{1,1}\) diffeomorphisms of the ambient space. Here, a \(C^{1,1}\) map is a \(C^{1}\) map whose derivative is Lipschitz, and a \(C^{1,1}\) diffeomorphism is a \(C^{1,1}\) bijective map whose inverse is also \(C^{1,1}\). Chazal and Soufflet [13] proved that the medial axis is stable with respect to the Hausdorff distance under ambient diffeomorphisms, but under stronger assumptions than the work of Federer, namely assuming that \(\mathcal{S}\) is a \(C^{2}\) manifold and the distortion is a \(C^{2}\) diffeomorphism of the ambient space. Chazal and Soufflet based their work on earlier results by Blaschke [9], which were not as strong as Federer's.

In this paper we extend the stability result of the medial axis. More concretely, we generalize the result of Chazal and Soufflet [13] to arbitrary closed sets and \(C^{1,1}\) diffeomorphisms of the ambient space; we show that the Hausdorff distance between the medial axes of the closed set and its image is bounded in terms of Lipschitz constants stemming from the diffeomorphism of the ambient space. Our result follows from the work of Federer [19] and in fact shortens the proof in [13] significantly.

Our bounds on the Hausdorff distance say nothing about the topology of the medial axis, which is known to be highly unstable (see e.g. [5]), although it preserves the homotopy type (see [28]).

Contribution and related workOur work differs from the majority of the literature in three essential ways:

Firstly, we make no assumptions on the set we consider apart from that it is closed. The stability of the medial axis of (piecewise) smooth manifolds has been the object of intense study, see for example [13, 15, 16, 17, 24, 30, 37, 38, 39, 40]. However, the manifold assumption is impossible to achieve in many applications -- such as in the context of astrophysics, one of the main motivations of this paper.

Secondly, we achieve stability without pruning the medial axis. This contrasts with a large body of work, such as [6, 12, 16, 29]. Not having to prune the medial axis is a significant advantage. On the downside, we limit the changes of the considered set to those induced by ambient diffeomorphisms. Nevertheless, given the standard examples of the instability of the medial axis -- see for example [5] -- we believe these limitations are near to the weakest assumptions necessary for Hausdorff stability. Within the context of ambient homeomorphisms, the results we obtain are close to optimal, as we specify in Remark 4.2.

Thirdly, our results hold for sets in arbitrary dimensions and are not sensitive to the dimension of the set itself. A large part of the related work only investigates sets of low dimensions or codimension one manifolds, although there are some notable exceptions such as [39], see also [17], and [12, 29].

MotivationThe medial axis has many real world applications -- among others, in robot motion planning [27], triangulation algorithms [4], graphics [35], and shape recognition, segmentation, and learning [10, 18, 25, 33, 41]. See also the overviews [32, 35]. The reach -- the distance between a set and its medial axis -- is a central concept in manifold learning [1, 2, 20, 21, 22, 34].

The motivation of this paper is twofold: Firstly, we tackle the following challenge from the processing of images collected with optical devices which use lenses -- such as cameras or telescopes. A shape extracted from such an image may be imprecise due to the imperfection of the lenses. Our result implies that the medial axis of such a shape is stable under these imperfections. As a consequence, the outcome of any shape recognition or shape segmentation algorithm based on the medial axis will be stable.

In addition to the disciplines listed above, such stability is sought after in astrophysics, in particular for shape analysis and automated shape identification in observational astronomy. Observational astronomers are interested in reconstructing objects like stars or galaxies, and their place in the universe from data gathered by telescopes. They can deduce the distance from the object to the observer thanks to so-called standard candles or red shift [14, 23, 31]. However, the image gets distorted due to optical effects -- either through gravitational lensing ([7]) or lensing inside the telescope itself ([36]).

Such a distortion can be modeled as a diffeomorphism of the ambient space. At the same time, this problem cannot be tackled using the result by Chazal and Soufflet [13], since the observed objects might not be smooth -- for example due to interactions with shock waves or jets. In addition, with our method astrophysicists can not only reconstruct objects in space (3D), but also in spacetime (4D).

The second motivation is more formal in nature: The stability of the medial axis is instrumental in establishing its computability. Indeed, when proving properties of algorithms based on the medial axis, authors generally assume the real RAM model.1 However, as was recently argued in [29], the medial axis needs to be stable in order to be computable in more realistic models of computation.

Footnote 1: The real RAM model is a standard, albeit non-realistic, assumption in Computational Geometry. It assumes one can calculate precisely with real numbers, instead of using \(0\)s and \(1\)s (which is the usual assumption in computer science).

There is a more practical component to this formal question: It is not a priori clear if using possibly noisy real world data or the output of other computer programs as input for these algorithms yields answers that are close to the ground truth. To be able to prove that the output is correct, we need (numerical) stability of the medial axis.

OutlineAfter revisiting preliminaries and known results in Section 2, we state the main stability result in Section 3. In Section 4 we reformulate this result in terms of norms on Banach spaces. This also exhibits the fact that the stability of the medial axis is Lipschitz in the following sense: We think of the set \(\mathcal{S}\) as fixed and consider the map from the space of diffeomorphisms (endowed with a norm which makes it a Banach space) to the space of closed subsets of \(\mathbb{R}^{d}\) (endowed with the Hausdorff distance), mapping each diffeomorphism \(F:\mathbb{R}^{d}\rightarrow\mathbb{R}^{d}\) to the closure of the medial axis of \(F(\mathcal{S})\). The Lipschitz constant then only depends on the diameter of the bounding sphere of the set \(\mathcal{S}\).

We only include proof sketches of the two main theorems in this article. The full proofs of the theorems and of the supporting lemmas, can be found in the supplementary material.

## 2 Preliminaries: Sets of positive reach and the closest point projection

In this section we recall some definitions and results concerning the medial axis and sets of positive reach. Essentially, we need three ingredients from the literature to prove our main theorem: the notions related to the closest point projection, the properties of the generalized normal and tangent spaces, and Federer's result on the stability of the reach under ambient diffeomorphisms.

We write \(d(\cdot,\cdot)\) for the Euclidean distance between two points, and the distance between a point and a set. That is, for any closed set \(\mathcal{S}\) and point \(p\),

\[d(p,\mathcal{S})=\inf_{q\in\mathcal{S}}d(p,q).\]

We denote the Hausdorff distance between two sets \(A,B\subseteq\mathbb{R}^{d}\) by \(d_{H}(A,B)\):

\[d_{H}(A,B)=\max\left\{\sup_{a\in A}d(a,B),\sup_{b\in B}d(b,A)\right\}.\]

We write \(B(c,r)\), resp. \(S(c,r)\), to denote balls, resp. spheres, with centre \(c\) and radius \(r\). Lastly, \(\left|\cdot\right|\) denotes the Euclidean norm, and \(\left\|\cdot\right\|\) an operator norm.

The closest point projection and related notionsThe projection of points in the ambient space \(\mathbb{R}^{d}\) to the (set of) closest point(s) of the set \(\mathcal{S}\subseteq\mathbb{R}^{d}\) is denoted by \(\pi_{\mathcal{S}}\), and illustrated in Figure 1.

The _medial axis_ of \(\mathcal{S}\) is the set of all points \(p\in\mathbb{R}^{d}\) where the set \(\pi_{\mathcal{S}}(p)\) consists of more than one point:

\[\mathrm{ax}(\mathcal{S})=\left\{p\in\mathbb{R}^{d}\mid\#\pi_{\mathcal{S}}(p)>1 \right\}.\]

Here, \(\#\pi_{\mathcal{S}}(p)\) denotes the cardinality of the set \(\pi_{\mathcal{S}}(p)\).

For a point \(p\in\mathcal{S}\), the _local feature size of \(p\)_ is the distance from \(p\) to the medial axis of the set \(\mathcal{S}\):

\[\mathrm{lfs}(p)=d(p,\mathrm{ax}(\mathcal{S})).\]

Finally, the _reach_ of the set \(\mathcal{S}\) is the infimum of the local feature size over all its points:

\[\mathrm{rch}(\mathcal{S})=\inf_{p\in\mathcal{S}}\mathrm{lfs}(p)=\inf_{p\in \mathcal{S}}d(p,\mathrm{ax}(\mathcal{S})).\]

**Throughout this paper we assume that \(\mathcal{S}\subseteq\mathbb{R}^{d}\) is a closed set.** We shall further assume that the set \(\mathcal{S}\) as well as its medial axis are bounded, and that the bounding sphere of \(\mathcal{S}\) is contained in \(\mathcal{S}\) itself.

Figure 1: The closest point projection to the set \(\mathcal{S}\) of four points in \(\mathbb{R}^{2}\). When a point lies on the medial axis \(\mathrm{ax}(\mathcal{S})\), the closest point projection consists of more points.

More specifically, we assume that there exists a closed ball \(B\) of positive radius such that \(\mathcal{S}\subseteq B\), and \(\partial B\subseteq\mathcal{S}\). We call \(\partial B\) the bounding sphere of \(\mathcal{S}\).

The addition of the bounding sphere \(\partial B\) to the set \(\mathcal{S}\) is necessary to obtain the desired bound on the Hausdorff distance between the two medial axes of the set \(\mathcal{S}\) and its image under the ambient diffeomorphism. Indeed, consider the following example, illustrated in Figure 2.

Let the set \(\mathcal{S}\) consist of two points in the plane, \(\mathcal{S}=\{p,q\}\subseteq\mathbb{R}^{2}\). The medial axis of \(\mathcal{S}\) is then the bisector line of \(p\) and \(q\). After a generic perturbation \(F\) of \(p\) and \(q\) -- that is, not a translation and not a perturbation in the direction \(\pm(p-q)\) -- the bisector line \(\mathrm{ax}(F(\mathcal{S}))\) of the perturbed points intersects the bisector \(\mathrm{ax}(\mathcal{S})\) of the original pair. The Hausdorff distance between these two non-parallel lines is infinite, and thus unboundable.

At the same time, the addition of the bounding sphere \(\partial B\) to the considered set \(\mathcal{S}\) is not a restriction. Indeed,

**Remark 2.1**: _The medial axes of \(\mathcal{S}\) and \(\mathcal{S}\setminus\partial B\) coincide in the interior of the ball \(B\) sufficiently far away from its boundary \(\partial B\). More precisely:_

* _Any point_ \(x\in\mathrm{ax}(\mathcal{S})\)_, such that_ \(\pi_{\mathcal{S}}(x)\cap\partial B=\emptyset\)_, lies on the medial axis_ \(\mathrm{ax}(\mathcal{S}\setminus\partial B)\)_._
* _Conversely, if a point_ \(x\) _lies on the medial axis_ \(\mathrm{ax}(\mathcal{S}\setminus\partial B)\)_, and any (and thus every) point_ \(q\in\pi_{\mathcal{S}\setminus\partial B}(x)\) _satisfies_ \(d(x,q)<d(x,\partial B)\)_, then_ \(x\in\mathrm{ax}(\mathcal{S})\)_._

_Thus, the medial axis is locally stable if the ambient diffeomorphism is close to the identity.2_

Footnote 2: The bounding sphere does allow one to give a relatively clean mathematical statement, see Section 4.

A recurring strategy in this article is to start at a point \(p\) on the set \(\mathcal{S}\), move away from this point in a 'normal' direction, and see if by projecting using the closest point projection \(\pi_{\mathcal{S}}\) we get back to \(p\). To this end, we define the _projection range_.

**Definition 2.2** (Projection range): _Let \(p\in\mathcal{S}\) be a point and \(v\in\mathbb{R}^{d}\) a vector. The projection range \(d(p,v,\pi_{\mathcal{S}})\) in direction \(v\) is the maximal distance one can travel from \(p\) along \(v\) such that the closest point projection yields only the point \(p\):_

\[d(p,v,\pi_{\mathcal{S}})=\sup\{\lambda\in\mathbb{R}\mid\pi_{\mathcal{S}}(p+ \lambda v)=\{p\}\}.\]

Since \(\pi_{\mathcal{S}}(p)=\{p\}\), the projection range is canonically non-negative. Furthermore, the directions for which the range is positive are key to our study, because of the following property:

**Lemma 2.3** (Theorem 4.8 (6) of [19]): _Consider a point \(p\in\mathcal{S}\) and a vector \(v\in\mathbb{R}^{d}\). If_

\[0<d(p,v,\pi_{\mathcal{S}})<\infty,\]

_then \(p+d(p,v,\pi_{\mathcal{S}})\cdot v\in\overline{\mathrm{ax}(\mathcal{S})}\)._

We call these special directions \(v\)_back projection vectors_:

**Definition 2.4** (Unit back projection vectors): _For a point \(p\in\mathcal{S}\), \(\mathrm{UBP}(p,\mathcal{S})\) is the set of unit vectors with a positive projection range:_

\[\mathrm{UBP}(p,\mathcal{S})=\left\{u\in\mathbb{R}^{d}\mid|u|=1\text{ and }0<d(p,u,\pi_{\mathcal{S}})<\infty\right\}.\]

_We further define_

\[\mathrm{UBP}(\mathcal{S})=\left\{(p,u)\in\mathcal{S}\times\mathbb{R}^{d} \,\big{|}\,u\in\mathrm{UBP}(p,\mathcal{S})\right\},\]

\[\mathrm{BP}(\mathcal{S})=\left\{(p,\lambda u)\in\mathcal{S}\times\mathbb{R}^{ d}\,\big{|}\,(p,u)\in\mathrm{UBP}(\mathcal{S}),\lambda\geq 0\right\}.\]

Figure 2: In black the set \(\mathcal{S}\) and its medial axis, in light blue the perturbed set and its medial axis. The Hausdorff distance between \(\mathrm{ax}(\mathcal{S})\) and \(\mathrm{ax}(F(\mathcal{S}))\) is infinite.

Thanks to Lemma 2.3, the following map is well-defined:

\[\pi_{\mathrm{ax},\mathcal{S}}:\mathrm{UBP}(\mathcal{S})\to\overline{\mathrm{ax}( \mathcal{S})},\qquad(p,u)\mapsto p+d(p,u,\pi_{\mathcal{S}})u. \tag{1}\]

The generalized tangent and normal spaceBack projection vectors are intricately related to the generalized tangent and normal spaces.

**Definition 2.5** (Definitions 4.3 and 4.4 of [19]): _Let \(p\in\mathcal{S}\). The generalized tangent space \(\mathrm{Tan}(p,\mathcal{S})\) is the set of vectors \(u\in\mathbb{R}^{d}\), such that either \(u=0\) or, for every \(\varepsilon>0\) there exists a point \(q\in\mathcal{S}\) with_

\[0< |q-p|<\varepsilon\] _and_ \[\left|\frac{q-p}{|q-p|}-\frac{u}{|u|}\right|<\varepsilon.\]

_The generalized normal space \(\mathrm{Nor}(p,\mathcal{S})\) consists of vectors \(v\in\mathbb{R}^{d}\) such that \(\langle v,u\rangle\leq 0\) for all \(u\in\mathrm{Tan}(p,\mathcal{S})\). Vectors contained in the generalized tangent, resp. normal, space are called tangent, resp. normal, to \(\mathcal{S}\) at \(p\)._

The generalized tangent and normal spaces are illustrated in Figure 3.

Stability of the reach under ambient diffeomorphismsOur last ingredient is the following result by Federer.

**Theorem 2.6** (Stability of the reach under ambient diffeomorphisms, Theorem 4.19 of [19]): _Pick two constants \(0<t<\mathrm{rch}(\mathcal{S})\) and \(s>0\). If the map_

\[F:\{x\in\mathbb{R}^{d}\mid d(x,\mathcal{S})<s\}\to\mathbb{R}^{n}\]

_is injective and continuously differentiable, and the maps \(F\), \(F^{-1}\), and \(DF\) are Lipschitz continuous with Lipschitz constants \(\mathrm{Lip}(F)\), \(\mathrm{Lip}(F^{-1})\), \(\mathrm{Lip}(DF)\), respectively, then the reach \(\mathrm{rch}(F(\mathcal{S}))\) of the image of the set \(\mathcal{S}\) under the map \(F\) is lower-bounded by_

\[\mathrm{rch}(F(\mathcal{S}))\geq\min\left\{\frac{s}{\mathrm{Lip}(F^{-1})}, \frac{1}{\left(\frac{\mathrm{Lip}(F)}{t}+\mathrm{Lip}(DF)\right)\left(\mathrm{ Lip}(F^{-1})\right)^{2}}\right\}.\]

## 3 Stability of the medial axis under ambient diffeomorphisms

In this section we present the main result of this paper, Theorem 3.9. This theorem extends earlier work by Chazal and Soufflet [13]. Its proof relies on Federer's result on the stability of the reach, Theorem 2.6. To give a more geometrical interpretation we introduce the concept of a weakly tangent sphere and ball, and a maximal empty weakly tangent ball.

Figure 3: The (affine) generalized tangent and normal spaces of four points in the set \(\mathcal{S}\subset\mathbb{R}^{2}\), in light blue and violet, respectively.

**Definition 3.1** (Weakly tangent sphere and ball): _Let \(p\in\mathcal{S}\). A sphere is called weakly tangent to \(\mathcal{S}\) at \(p\) if it contains the point \(p\) and its centre lies in the (translated) generalized normal space \(\mathrm{Nor}(p,\mathcal{S})+p\). In other words, spheres weakly tangent to \(\mathcal{S}\) at \(p\) are spheres with centres \(p+v\) and radii \(|v|\), for a vector \(v\in\mathrm{Nor}(p,\mathcal{S})\)._

_A ball is called weakly tangent to \(\mathcal{S}\) at \(p\) if its boundary sphere is weakly tangent to \(\mathcal{S}\) at \(p\)._

**Remark 3.2**: _Using the definition of \(\mathrm{Nor}(p,\mathcal{S})\), a weakly tangent ball can also be defined as follows: A ball \(B(c,r)\) is weakly tangent at \(p\) if and only if its centre \(c\) and radius \(r\) satisfy_

\[(p+\mathrm{Tan}(\mathcal{S},p))\cap B(c,r)=\{p\}.\]

We remark:

**Lemma 3.3**: _Let \(p\in\mathcal{S}\) and \(v\in\mathbb{R}^{d}\), and suppose that for some \(\lambda>0\) we have \(\pi_{\mathcal{S}}(p+\lambda v)\neq\{p\}\). Then, for all \(\lambda^{\prime}\geq\lambda\), we have \(\pi_{\mathcal{S}}(p+\lambda^{\prime}v)\neq\{p\}\) and for all \(\lambda^{\prime}>\lambda\), that \(p\notin\pi_{\mathcal{S}}(p+\lambda^{\prime}v)\)._

Lemma 3.3 essentially tells us that a family of weakly tangent balls \(\{B(p+\lambda v,\lambda|v|)\}_{\lambda\geq 0}\) contains at most one which is maximal with respect to inclusion among those whose interior is disjoint from the set \(\mathcal{S}\). Two such families are illustrated in Figure 4.

We call such balls _maximal empty_. For the purpose of this article, we define maximal empty balls in terms of unit back projection vectors (Definition 2.4). To see that each maximal empty ball is indeed weakly tangent, we emphasise:

**Lemma 3.4**: _If \((p,v)\in\mathrm{BP}(\mathcal{S})\), then \((p,v)\in\mathrm{Nor}(\mathcal{S})\). That is, \(\mathrm{BP}(\mathcal{S})\subseteq\mathrm{Nor}(\mathcal{S})\). In particular, for any pair \((p,u)\in\mathrm{UBP}(\mathcal{S})\) and radius \(\lambda\geq 0\), the ball \(B(p+\lambda u,\lambda)\) is weakly tangent to \(\mathcal{S}\)._

**Remark 3.5**: _For general closed sets, the converse of Lemma 3.4, that is, \(\mathrm{Nor}(\mathcal{S})\subseteq\mathrm{BP}(\mathcal{S})\), is not true. One counter-example is the graph of the function \(x\mapsto|x|^{3/2}\) at the origin. However, the inclusion \(\mathrm{Nor}(\mathcal{S})\subseteq\mathrm{BP}(\mathcal{S})\) holds for sets of positive reach, thanks to Theorem 4.8 (12) of [19] (recalled in the supplementary material)._

**Definition 3.6** (Maximal empty weakly tangent ball): _Let \((p,u)\in\mathrm{UBP}(\mathcal{S})\). A weakly tangent ball \(B(p+\lambda u,\lambda)\) is called maximal empty to \(\mathcal{S}\) if \(\lambda=d(p,u,\pi_{\mathcal{S}})\), or, equivalently, if \(\pi_{\mathrm{ax},\mathcal{S}}(p,u)=p+\lambda u\)._

**(Maximal empty) weakly tangent balls satisfy the following properties. Let \((p,u)\in\mathrm{UBP}(\mathcal{S})\).**

* **For any radius** \(0<\lambda\leq d(p,u,\pi_{\mathcal{S}})\)**, the interior of the ball** \(B(p+\lambda u,\lambda)\) **is disjoint from the set** \(\mathcal{S}\)**. This follows directly from Definition 3.6 and Lemma 3.3.**
* **The centres of maximal empty weakly tangent balls lie on the closure of the medial axis of** \(\mathcal{S}\)**. This is due to Lemma 2.3 and the definition of the map** \(\pi_{\mathrm{ax},\mathcal{S}}\) **(equation (1)).**

Figure 4: Two families of balls weakly tangent to the set \(\mathcal{S}\subset\mathbb{R}^{2}\) (in blue). Each family contains a unique maximal empty ball (in purple). Notice that the centre of the maximal empty ball weakly tangent at the point \(p_{1}\) lies at the medial axis \(\mathrm{ax}(\mathcal{S})\), while the centre of the maximal empty ball weakly tangent at the point \(p_{2}\) only lies at its closure, \(\overline{\mathrm{ax}(\mathcal{S})}\).

The following lemma moreover tells us, that each point on the medial axis is a centre of a maximal empty weakly tangent ball.

**Lemma 3.7** (Surjectivity on \(\operatorname{ax}(\mathcal{S})\)): _For any point \(x\in\operatorname{ax}(\mathcal{S})\) and \(p\in\pi_{\mathcal{S}}(x)\), there exists a vector \(u\in\operatorname{UBP}(p,\mathcal{S})\) such that \(\pi_{\operatorname{ax},\mathcal{S}}(p,u)=x\). In other words, \(B(x,|x-p|)\) is a maximally empty weakly tangent ball. Moreover, we have that_

\[\operatorname{ax}(\mathcal{S})\subseteq\pi_{\operatorname{ax},\mathcal{S}} \left(\operatorname{UBP}(\mathcal{S})\right)\subseteq\overline{\operatorname{ ax}(\mathcal{S})}.\]

We are now almost ready to state our main theorem. Before phrasing the result, we walk the reader through the assumptions and fix the notation on the way. The assumptions are illustrated in Figure 5.

**Assumption 3.8**:
* _We assume that the set_ \(\mathcal{S}\) _has a bounding sphere of radius_ \(r\)_, which we denote by_ \(S(r)\)_._
* _We consider a_ \(C^{1}\) _diffeomorphism_ \(F:\mathbb{R}^{d}\to\mathbb{R}^{d}\) _such that the Lipschitz constants of_ \(F\) _and_ \(F^{-1}\) _are bounded by_ \(L_{F}\)_, and the Lipschitz constants of the differentials_ \(DF\) _and_ \(DF^{-1}\) _are bounded by_ \(L_{DF}\)_. We call such a diffeomorphism a_ \(C^{1,1}\) _diffeomorphism._
* _We further assume that the map_ \(F\) _leaves the bounding sphere_ \(S(r)\) _invariant, that is,_ \(F(S(r))=S(r)\)_._
* _We pick a point_ \(c\in\operatorname{ax}(\mathcal{S})\)_, a point_ \(p\in\pi_{\mathcal{S}}(c)\)_, and write_ \(\rho=|c-p|\)_. Observe that since_ \(\mathcal{S}\cap\operatorname{ax}(\mathcal{S})=\emptyset\)_,_ \(\rho\) _is positive. By Lemma_ 3.7_, the ball_ \(B(c,\rho)\) _is a maximal empty weakly tangent ball to_ \(\mathcal{S}\) _at_ \(p\)_. Moreover, we define_ \(u=\frac{\operatorname{c-}p}{|c-p|}\) _and note that_ \(u\in\operatorname{UBP}(p,\mathcal{S})\)_._
* _We denote the tangent hyperplane to the boundary sphere of_ \(B(c,\rho)\) _at_ \(p\) _by_ \(p+T\)_. The hyperplane_ \(T\) _is the orthocomplement of the vector_ \(u\)_:_ \(T=u^{\perp}\)_._
* _We work with the unit vector at_ \(F(p)\) _that points inside the image of the ball_ \(B(c,\rho)\) _and is orthogonal to the hyperplane_ \(D_{p}F(T)\)_. We denote this vector by_ \(u^{\prime}\)_._

**Theorem 3.9**: _Under the above assumptions, there exists a maximal empty weakly tangent ball \(B(c^{\prime},\rho^{\prime})\) to the set \(F(\mathcal{S})\), whose boundary sphere has an internal normal \(u^{\prime}\). In particular, the ball \(B(c^{\prime},\rho^{\prime})\) is tangent to the affine hyperplane \(F(p)+D_{p}F(T)\). Its radius \(\rho^{\prime}\) is bounded by \(\rho^{\prime}\in\left[\frac{\rho}{(L_{F})^{3}+\rho L_{F}(L_{F})^{2}},\frac{(L _{F})^{3}}{1-\rho L_{DF}(L_{F})^{2}}\right].\) Assume, moreover, that the distortions of both \(F\) and \(DF\) are bounded, that is, for all \(x\in\mathbb{R}^{d}\),_

\[|F(x)-x|\leq\varepsilon_{1},\qquad\|DF_{x}-\operatorname{Id}\|\leq\varepsilon _{2}<1, \tag{2}\]

_and \(r\cdot L_{DF}(L_{F})^{2}\leq 1/2\). Define_

\[C_{L}(r,L_{F},L_{DF},\varepsilon_{1},\varepsilon_{2})=\] \[2r\sqrt{1+(L_{F})^{6}\left(1+4rL_{DF}(L_{F})^{2}\right)^{2}-2(L_ {F})^{3}\left(1+4rL_{DF}(L_{F})^{2}\right)\sqrt{1-(\varepsilon_{2})^{2}}}+ \varepsilon_{1}\]

_then the map \(\pi_{\operatorname{ax},\mathcal{S}}\) satisfies_

\[|\pi_{\operatorname{ax},\mathcal{S}}(p,u)-\pi_{\operatorname{ax},F(\mathcal{S} )}(F(p),u^{\prime})|\leq C_{L}(r,L_{F},L_{DF},\varepsilon_{1},\varepsilon_{2}).\]

Figure 5: The setting of Theorem 3.9.

_Thus, the Hausdorff distance between the medial axes of \(\mathcal{S}\) and its image \(F(\mathcal{S})\) is bounded by_

\[d_{H}(\operatorname{ax}(\mathcal{S}),\operatorname{ax}(F(\mathcal{S})))\leq C_{L }(r,L_{F},L_{DF},\varepsilon_{1},\varepsilon_{2}). \tag{3}\]

The bound \(|F(x)-x|\leq\varepsilon_{1}\) is really necessary, because we want our theorem to accommodate for rotations and translations, which rotate and translate the medial axis without changing distances and hence have Lipschitz constant 1. We further stress that if the diffeomorphism \(F\) is close to the identity, its Lipschitz constant satisfies \(L_{F}\geq 1\), because by assumption \(F\) leaves the bounding sphere \(S(r)\) invariant, and \(L_{DF}\) is close to zero.

Sketch of the proof of Theorem 3.9.: The idea of the proof is depicted in Figure 5. Thanks to Federer's result (Theorem 2.6), we know that the reach of the maximal empty weakly tangent ball \(B(c,\rho)\) does not change too much under the ambient diffeomorphism \(F\). This gives a lower bound on the radius of every maximal empty weakly tangent ball of the image of this ball -- the set \(F(B(c,\rho))\). We show that in the interior of \(F(B(c,\rho))\), the radii of the maximal empty weakly tangent balls of \(F(B(c,\rho))\) are close to \(\rho\). One of these balls is also empty weakly tangent to \(F(\mathcal{S})\) at \(F(p)\), though not necessarily maximal. We denote its centre by \(c^{\prime}\). Since we can apply the same argument for the map \(F^{-1}\), we find an upper and lower bound on the radius of the maximal weakly tangent ball \(B(c^{\prime},\rho^{\prime})\) of \(F(\mathcal{S})\) at \(F(p)\) that is also weakly tangent to \(F(B(c,\rho))\), or equivalently tangent to \(D_{p}F(T)\).

While this bound on the difference of the radii is essentially a bound on the distance \(||c-p|-|c^{\prime}-F(p)||\) between the points \(c-p\) and \(c^{\prime}-F(p)\), the bound \(\varepsilon_{2}\) on \(\|DF-1\|\) allows one to bound the angle between the vectors \(c-p\) and \(c^{\prime}-F(p)\). With the assumption (2) we can then derive a bound the distance between the points \(c\) and \(c^{\prime}\). Finally, thanks to [19, Theorem 4.8 (6)] (Lemma 2.3) this induces a bound on the Hausdorff distance between the (closure of the) two medial axes \(\operatorname{ax}(S)\) and \(\operatorname{ax}(F(S))\). 

It was a surprise to the authors that no assumption on the set (apart from closedness) needed to be made, and that the techniques used were that simple and well established; they go back to Federer [19]. In fact, the authors at first envisioned a far more elaborate argument assuming the set had positive \(\mu\)-reach [11].

## 4 Quantifying \(C^{1,1}\) diffeomorphisms as deviations from identity

In this section we reformulate the main result in terms of norms on Banach spaces. This reformulation offers a more theoretical insight, and we believe the reformulated bounds are easier to work with in certain applications. Indeed, in the context of practical numerical computations, a bound on the Lipschitz constant of an operator -- or, at least, a modulus of continuity -- allows to control the condition number. This control is particularly useful when we calculate with objects such as the medial axis,whose (numerical) stability is often problematic in practice.

As we will see below, for this reformulation we somewhat strengthen our assumptions.

We decompose a diffeomorphism \(F\) into the identity map \(\mathds{1}_{\mathbb{R}^{d}}\) on \(\mathbb{R}^{d}\), and a displacement field \(\varphi\): \(F=\mathds{1}_{\mathbb{R}^{d}}+\varphi\). For the choice of the displacement field, we restrict ourselves to the vector space \(\mathcal{U}\) of all \(C^{1,1}\) maps \(\varphi\) from \(\mathbb{R}^{d}\) to \(\mathbb{R}^{d}\) whose restriction to the exterior \(\mathbb{R}^{d}\setminus B(r)\) of a certain bounding ball \(B(r)\) equals 0.3

Footnote 3: This is more restrictive than assuming that the restriction to the bounding sphere \(S(r)\) is \(0\), but it simplifies matters in this section.

A natural norm associated to \(\mathcal{U}\) is one that makes it a Banach space. A typical choice, inherited from general Banach spaces of \(C^{1,1}\) functions, would be for example, for \(\varphi\in\mathcal{U}\),

\[\|\varphi\|_{C^{1,1}}=\max\left(\|\varphi\|_{\infty},\,\|D\varphi\|_{\infty}, \,\operatorname{Lip}(D\varphi)\right). \tag{4}\]

Here we used the following notation:

* \(\|\varphi\|_{\infty}=\sup_{x\in\mathbb{R}^{d}}|\varphi(x)|\) denotes the sup norm on \(x\mapsto|\varphi(x)|\), where \(|\cdot|\) is the Euclidean norm in \(\mathbb{R}^{d}\),
* \(\|D\varphi\|_{\infty}=\sup_{x\in\mathbb{R}^{d}}\|D\varphi(x)\|\) denotes the sup norm on \(x\mapsto\|D\varphi(x)\|\), where \(\|D\varphi(x)\|\) is the operator norm induced by the Euclidean norm on \(\mathbb{R}^{d}\).

* We write \(\operatorname{Lip}(D\varphi)\) for the Lipschitz semi-norm of \(D\varphi\). The Lipschitz semi-norms of \(\varphi\) and \(D\varphi\) are defined as \[\operatorname{Lip}(\varphi)=\sup_{x,y\in\mathbb{R}^{d},\,x\neq y}\frac{|\varphi( y)-\varphi(x)|}{|y-x|},\] and \[\operatorname{Lip}(D\varphi)=\sup_{x,y\in\mathbb{R}^{d},\,x\neq y}\frac{\|D \varphi(y)-D\varphi(x)\|}{|y-x|}.\]

The norm defined in (4) makes \(\mathcal{U}\) into a Banach space, since every Cauchy sequence in \(\mathcal{U}\) has a limit in \(\mathcal{U}\). In addition, any function \(\varphi\in\mathcal{U}\) satisfies:

\[\operatorname{Lip}(\varphi) =\|D\varphi\|_{\infty}, \tag{5}\] \[\|D\varphi\|_{\infty} \leq r\operatorname{Lip}(D\varphi),\] (6) \[\|\varphi\|_{\infty} \leq r\operatorname{Lip}(\varphi)\leq r^{2}\operatorname{Lip}(D \varphi), \tag{7}\]

since the restriction of \(\varphi\) to \(\mathbb{R}^{d}\setminus B(r)\) is \(0\). This in turn yields that \(\operatorname{Lip}(D\varphi)\leq\|\varphi\|_{\mathbb{C}^{1,1}}\leq\max(1,r,r^ {2})\operatorname{Lip}(D\varphi)\). Thus, in \(\mathcal{U}\), the norm \(\varphi\mapsto\operatorname{Lip}(D\varphi)\) is equivalent to the norm \(\varphi\mapsto\|\varphi\|_{\mathbb{C}^{1,1}}\).

We can now state slightly less general version of Theorem 3.9 in terms of the Banach space \((\mathcal{U},\,\varphi\mapsto\operatorname{Lip}(D\varphi)\,)\).

**Theorem 4.1**: _Let \(\mathcal{S}\subseteq\mathbb{R}^{d}\) be bounded by the ball \(B(r)\) of radius \(r>0\), such that \(S(r)=\partial B(r)\subseteq\mathcal{S}\). Let further \(F\) be a \(C^{1,1}\) diffeomorphism from \(\mathbb{R}^{d}\) to itself that leaves the set \(\mathbb{R}^{d}\setminus B(r)\) invariant, and define two displacement fields \(\varphi,\tilde{\varphi}\in\mathcal{U}\) such that \(F=\mathds{1}_{\mathbb{R}^{d}}+\varphi\) and_

\[\left(\mathds{1}_{\mathbb{R}^{d}}+\tilde{\varphi}\right)\circ\left(\mathds{1}_ {\mathbb{R}^{d}}+\varphi\right)=\mathds{1}_{\mathbb{R}^{d}}.\]

_Define \(\varepsilon=\max\left(\operatorname{Lip}(D\varphi),\operatorname{Lip}(D\tilde{ \varphi})\right)\)._

_If \(r\varepsilon\leq 1/4\), the Hausdorff distance between the medial axes of the set \(\mathcal{S}\) and its image \(F(\mathcal{S})\) is bounded by \(d_{H}(\operatorname{ax}(\mathcal{S}),\operatorname{ax}(F(\mathcal{S})))\leq \left(1+\sqrt{50}\right)r^{2}\varepsilon+\mathcal{O}\left(r^{3}\varepsilon^{2}\right)\). In particular, \(d_{H}(\operatorname{ax}(\mathcal{S}),\operatorname{ax}(F(\mathcal{S})))= \mathcal{O}\left(r^{2}\varepsilon\right)\)._

_Sketch of the proof_  Essentially, the proof consists of rewriting Theorem 3.9 in terms of the language developed in this section. \(\square\)

**Remark 4.2**: _Observe that the bound \(\mathcal{O}\left(r^{2}\varepsilon\right)\) is consistent with a scaling by factor \(\lambda\): \(\mathcal{S}\mapsto\lambda\,\mathcal{S}\), \(F(\cdot)\mapsto\lambda\,F(\cdot/\lambda)\). Under such a scaling, the radius \(r\) is multiplied by \(\lambda\), while the Lipschitz constant \(\operatorname{Lip}(D\varphi)\) -- and therefore \(\varepsilon\) -- is divided by \(\lambda\). Furthermore, the Hausdorff distance \(d_{H}(\operatorname{ax}(\mathcal{S}),\,\operatorname{ax}(F(\mathcal{S})))\) increases by a factor \(\lambda\). By considering a diffeomorphism that translates the set \(\mathcal{S}\setminus S(r)\) while keeping the bounding sphere \(S(r)\) fixed, we see that this bound is asymptotically optimal._

## 5 Conclusion and future work

We proved the Hausdorff stability of the medial axis of a closed set without any further assumption on it (as explained in Remark 2.1, the existence of the bounding sphere serves to formulate the main result in a clean way).

With regard to applications, our result is the first step towards providing a provably correct image recognition in particular in the context of astrophysics. The next step is to produce physics-informed models for the medial axis as occurring in astronomical data.

On the mathematical side, we conclude with a conjecture generalizing our result. We believe that our result generalizes to compact Riemannian manifolds with bounded curvature.

**Conjecture 5.1**: _Let \(\mathcal{M}\) be a compact Riemannian manifold with bounded sectional curvature4 and \(\mathcal{S}\) a closed subset of \(\mathcal{M}\). Then the medial axis (also called cut locus [26]) of \(\mathcal{S}\) in \(\mathcal{M}\) is Lipschitz stable under diffeomorphisms of \(\mathcal{M}\)._

## References

* Aamari and Knop [2021] Eddie Aamari and Alexander Knop. Statistical query complexity of manifold estimation. In _Proceedings of the 53rd Annual ACM SIGACT Symposium on Theory of Computing_, STOC 2021, pages 116-122, New York, NY, USA, 2021. Association for Computing Machinery.
* Aamari and Levrard [2018] Eddie Aamari and Clement Levrard. Stability and minimax optimality of tangential Delaunay complexes for manifold reconstruction. _Discrete & Computational Geometry_, 59:923-971, 2018.
* Amenta and Bern [1999] N. Amenta and M. Bern. Surface reconstruction by Voronoi filtering. _Discrete & Computational Geometry_, 22(4):481-504, Dec 1999.
* Amenta et al. [2001] Nina Amenta, Sunghee Choi, and Ravi Krishna Kolluri. The power crust. In _Proceedings of the sixth ACM symposium on Solid modeling and applications_, pages 249-266, 2001.
* a state-of-the-art report. In Torsten Moller, Bernd Hamann, and Robert D. Russell, editors, _Mathematical Foundations of Scientific Visualization, Computer Graphics, and Massive Data Exploration_, pages 109-125, Berlin, Heidelberg, 2009. Springer Berlin Heidelberg.
* Attali and Montanvert [1997] Dominique Attali and Annick Montanvert. Computing and simplifying 2d and 3d continuous skeletons. _Computer vision and image understanding_, 67(3):261-273, 1997.
* Bartelmann [2010] Matthias Bartelmann. Gravitational lensing. _Classical and Quantum Gravity_, 27(23):233001, nov 2010.
* Berger [2003] M. Berger. _A Panoramic View of Riemannian Geometry_. Springer-Verlag, 2003.
* Blaschke [1916] W. Blaschke. _Kreis und Kugel_. Verlag von Veit und Comp., 1916.
* Chambers et al. [2018] Erin Chambers, Ellen Gasparovic, and Kathryn Leonard. Medial fragments for segmentation of articulating objects in images. _Research in Shape Analysis: WiSH2, Sirince, Turkey, June 2016_, pages 1-15, 2018.
* Chazal et al. [2009] F. Chazal, D. Cohen-Steiner, and A. Lieutier. A sampling theory for compact sets in Euclidean space. _Discrete and Computational Geometry_, 41(3):461-479, 2009.
* Chazal and Lieutier [2005] F. Chazal and A. Lieutier. The \(\lambda\)-medial axis. _Graphical Models_, 67(4):304-331, 2005.
* Chazal and Soufflet [2004] F. Chazal and R. Soufflet. Stability and finiteness properties of medial axis and skeleton. _Journal of Dynamical and Control Systems_, 10(2):149-170, 2004.
* Coble et al. [2020] Kim Coble, Kevin McLin, and Lynn Cominsky. _Big Ideas in Cosmology_. Libretexts Physics, 2020.
* Damon [2008] James Damon. _Geometry and Medial Structure_, pages 69-123. Springer Netherlands, Dordrecht, 2008.
* Damon [2021] James Damon. Rigidity properties of the blum medial axis. _Journal of Mathematical Imaging and Vision_, 63(1):120-129, 2021.
* Damon and Gasparovic [2017] James Damon and Ellen Gasparovic. _Medial/skeletal linking structures for multi-region configurations_, volume 250. American Mathematical Society, 2017.
* Demir et al. [2019] Ilke Demir, Camilla Hahn, Kathryn Leonard, Geraldine Morin, Dana Rahbani, Athina Pantopoulou, Amelie Fondevilla, Elena Balashova, Bastien Durx, and Adam Kortylewski. SkelNetOn 2019: Dataset and challenge on deep learning for geometric shape understanding. In _2019 IEEE/CVF Conference on Computer Vision and Pattern Recognition Workshops (CVPRW)_, pages 1143-1151, 2019.
* Federer [1959] H. Federer. Curvature measures. _Transactions of the America mathematical Society_, 93:418-491, 1959.

* [20] Charles Fefferman, Sergei Ivanov, Yaroslav Kurylev, Matti Lassas, and Hariharan Narayanan. Fitting a putative manifold to noisy data. In _Conference On Learning Theory_, pages 688-720. PMLR, 2018.
* [21] Charles Fefferman, Sergei Ivanov, Matti Lassas, and Hariharan Narayanan. Fitting a manifold of large reach to noisy data. _arXiv preprint arXiv:1910.05084_, 2019.
* [22] Charles Fefferman, Sergei Ivanov, Matti Lassas, and Hariharan Narayanan. Reconstruction of a Riemannian manifold from noisy intrinsic distances. _SIAM Journal on Mathematics of Data Science_, 2(3):770-808, 2020.
* [23] J. D. Fernie. The period-luminosity relation: A historical review. _Publications of the Astronomical Society of the Pacific_, 81(483):707, dec 1969.
* [24] Ellen Gasparovic. _The Blum medial linking structure for multi-region analysis_. PhD thesis, The University of North Carolina at Chapel Hill, 2012.
* [25] Seng-Beng Ho and Charles R Dyer. Shape smoothing using medial axis properties. _IEEE Transactions on Pattern Analysis and Machine Intelligence_, PAMI-8(4):512-520, 1986.
* [26] Vitali Kapovitch and Alexander Lytchak. Remarks on manifolds with two-sided curvature bounds. _Analysis and Geometry in Metric Spaces_, 9(1):53-64, 2021.
* [27] Jean-Claude Latombe. _Robot motion planning_, volume 124. Springer Science & Business Media, 2012.
* 1046, 2004. Solid Modeling Theory and Applications.
* [29] Andre Lieutier and Mathijs Wintraecken. Hausdorff and gromov-hausdorff stable subsets of the medial axis. _Proceedings of the 55th ACM Symposium on Theory of Computing (STOC 2023)_, 2023.
* [30] John N Mather. Distance from a submanifold in euclidean-space. In _Proceedings of symposia in pure mathematics_, volume 40, pages 199-216. AMER MATHEMATICAL SOC 201 CHARLES ST, PROVIDENCE, RI 02940-2213, 1983.
* [31] Phillip James Edwin Peebles. _Principles of physical cosmology_, volume 27. Princeton university press, 1993.
* [32] Punam K Saha, Gunilla Borgefors, and Gabriella Sanniti di Baja. A survey on skeletonization algorithms and their applications. _Pattern recognition letters_, 76:3-12, 2016.
* 169, 1998.
* [34] Barak Sober and David Levin. Manifold approximation by moving least-squares projection (MMLS). _Constructive Approximation_, 52(3):433-478, 2020.
* [35] Andrea Tagliasacchi, Thomas Delame, Michela Spagnuolo, Nina Amenta, and Alexandru Telea. 3d skeletons: A state-of-the-art report. In _Computer Graphics Forum_, volume 35, pages 573-597. Wiley Online Library, 2016.
* [36] Zhongwei Tang, Rafael Grompone Von Gioi, Pascal Monasse, and Jean-Michel Morel. A precision analysis of camera distortion models. _IEEE Transactions on Image Processing_, 26(6):2694-2704, 2017.
* [37] R. Thom. Sur le cut-locus d'une variete plongee. _Journal of Differential Geometry_, 6(4):577-586, 1972.
* [38] Martijn van Manen. Maxwell strata and caustics. In _Singularities In Geometry And Topology_, pages 787-824. World Scientific, 2007.

* [39] C. T. C. Wall. Geometric properties of generic differentiable manifolds. In Jacob Palis and Manfredo do Carmo, editors, _Geometry and Topology_, pages 707-774, Berlin, Heidelberg, 1977. Springer Berlin Heidelberg.
* [40] Franz-Erich Wolter. Cut locus and medial axis in global shape interrogation and representation. 1993.
* [41] Yajie Yan, Kyle Sykes, Erin Chambers, David Letscher, and Tao Ju. Erosion thickness on medial axes of 3d shapes. _ACM Transactions on Graphics_, 35(4):38:1-38:12, July 2016.